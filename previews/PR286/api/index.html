<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API reference · SparseMatrixColorings.jl</title><meta name="title" content="API reference · SparseMatrixColorings.jl"/><meta property="og:title" content="API reference · SparseMatrixColorings.jl"/><meta property="twitter:title" content="API reference · SparseMatrixColorings.jl"/><meta name="description" content="Documentation for SparseMatrixColorings.jl."/><meta property="og:description" content="Documentation for SparseMatrixColorings.jl."/><meta property="twitter:description" content="Documentation for SparseMatrixColorings.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SparseMatrixColorings.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li class="is-active"><a class="tocitem" href>API reference</a><ul class="internal"><li><a class="tocitem" href="#Main-function"><span>Main function</span></a></li><li><a class="tocitem" href="#Coloring-algorithms"><span>Coloring algorithms</span></a></li><li><a class="tocitem" href="#Result-analysis"><span>Result analysis</span></a></li><li><a class="tocitem" href="#Decompression"><span>Decompression</span></a></li><li><a class="tocitem" href="#Orders"><span>Orders</span></a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../dev/">Internals</a></li><li><a class="tocitem" href="../vis/">Visualization</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/gdalle/SparseMatrixColorings.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/gdalle/SparseMatrixColorings.jl/blob/main/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-reference"><a class="docs-heading-anchor" href="#API-reference">API reference</a><a id="API-reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-reference" title="Permalink"></a></h1><p>The docstrings on this page define the public API of the package.</p><article><details class="docstring"><summary id="SparseMatrixColorings.SparseMatrixColorings"><a class="docstring-binding" href="#SparseMatrixColorings.SparseMatrixColorings"><code>SparseMatrixColorings.SparseMatrixColorings</code></a> — <span class="docstring-category">Module</span></summary><section><div><pre><code class="language-julia hljs">SparseMatrixColorings</code></pre><p><strong>SparseMatrixColorings.jl</strong></p><p><a href="https://github.com/gdalle/SparseMatrixColorings.jl/actions/workflows/Test.yml?query=branch%3Amain"><img src="https://github.com/gdalle/SparseMatrixColorings.jl/actions/workflows/Test.yml/badge.svg?branch=main" alt="Build Status"/></a> <a href="https://gdalle.github.io/SparseMatrixColorings.jl/stable/"><img src="https://img.shields.io/badge/docs-stable-blue.svg" alt="Stable Documentation"/></a> <a href="https://gdalle.github.io/SparseMatrixColorings.jl/dev/"><img src="https://img.shields.io/badge/docs-dev-blue.svg" alt="Dev Documentation"/></a> <a href="https://app.codecov.io/gh/gdalle/SparseMatrixColorings.jl"><img src="https://codecov.io/gh/gdalle/SparseMatrixColorings.jl/branch/main/graph/badge.svg" alt="Coverage"/></a> <a href="https://github.com/JuliaDiff/BlueStyle"><img src="https://img.shields.io/badge/code%20style-blue-4495d1.svg" alt="Code Style: Blue"/></a> <a href="https://arxiv.org/abs/2505.07308"><img src="https://img.shields.io/badge/arXiv-2505.07308-b31b1b.svg" alt="arXiv"/></a> <a href="https://zenodo.org/doi/10.5281/zenodo.11314275"><img src="https://zenodo.org/badge/801999408.svg" alt="DOI"/></a></p><p>Coloring algorithms for sparse Jacobian and Hessian matrices.</p><p><strong>Getting started</strong></p><p>To install this package, run the following in a Julia Pkg REPL:</p><pre><code class="language-julia hljs">pkg&gt; add SparseMatrixColorings</code></pre><p><strong>Background</strong></p><p>The algorithms implemented in this package are described in the following preprint:</p><ul><li><a href="https://arxiv.org/abs/2505.07308"><em>Revisiting Sparse Matrix Coloring and Bicoloring</em></a>, Montoison et al. (2025)</li></ul><p>and inspired by previous works:</p><ul><li><a href="https://epubs.siam.org/doi/10.1137/S0036144504444711"><em>What Color Is Your Jacobian? Graph Coloring for Computing Derivatives</em></a>, Gebremedhin et al. (2005)</li><li><a href="https://epubs.siam.org/doi/abs/10.1137/050639879"><em>New Acyclic and Star Coloring Algorithms with Application to Computing Hessians</em></a>, Gebremedhin et al. (2007)</li><li><a href="https://pubsonline.informs.org/doi/abs/10.1287/ijoc.1080.0286"><em>Efficient Computation of Sparse Hessians Using Coloring and Automatic Differentiation</em></a>, Gebremedhin et al. (2009)</li><li><a href="https://dl.acm.org/doi/10.1145/2513109.2513110"><em>ColPack: Software for graph coloring and related problems in scientific computing</em></a>, Gebremedhin et al. (2013)</li></ul><p>Some parts of the articles (like definitions) are thus copied verbatim in the documentation.</p><p><strong>Alternatives</strong></p><ul><li><a href="https://github.com/michel2323/ColPack.jl">ColPack.jl</a>: a Julia interface to the C++ library <a href="https://github.com/CSCsw/ColPack">ColPack</a></li><li><a href="https://github.com/JuliaDiff/SparseDiffTools.jl">SparseDiffTools.jl</a>: contains Julia implementations of some coloring algorithms</li></ul><p><strong>Citing</strong></p><p>Please cite this software using the provided <code>CITATION.cff</code> file or the <code>.bib</code> entry below:</p><pre><code class="language-bibtex hljs">@unpublished{montoison2025revisitingsparsematrixcoloring,
      title={Revisiting Sparse Matrix Coloring and Bicoloring}, 
      author={Alexis Montoison and Guillaume Dalle and Assefaw Gebremedhin},
      year={2025},
      eprint={2505.07308},
      archivePrefix={arXiv},
      primaryClass={math.NA},
      url={https://arxiv.org/abs/2505.07308}, 
}</code></pre><p>The link <a href="https://zenodo.org/doi/10.5281/zenodo.11314275">https://zenodo.org/doi/10.5281/zenodo.11314275</a> resolves to the latest version on Zenodo.</p><p><strong>Exports</strong></p><ul><li><a href="#SparseMatrixColorings.AbstractColoringResult"><code>AbstractColoringResult</code></a></li><li><a href="#SparseMatrixColorings.ColoringProblem"><code>ColoringProblem</code></a></li><li><a href="#SparseMatrixColorings.ConstantColoringAlgorithm"><code>ConstantColoringAlgorithm</code></a></li><li><a href="#SparseMatrixColorings.DynamicDegreeBasedOrder"><code>DynamicDegreeBasedOrder</code></a></li><li><a href="#SparseMatrixColorings.DynamicLargestFirst"><code>DynamicLargestFirst</code></a></li><li><a href="#SparseMatrixColorings.GreedyColoringAlgorithm"><code>GreedyColoringAlgorithm</code></a></li><li><a href="#SparseMatrixColorings.IncidenceDegree"><code>IncidenceDegree</code></a></li><li><a href="#SparseMatrixColorings.LargestFirst"><code>LargestFirst</code></a></li><li><a href="#SparseMatrixColorings.NaturalOrder"><code>NaturalOrder</code></a></li><li><a href="#SparseMatrixColorings.OptimalColoringAlgorithm"><code>OptimalColoringAlgorithm</code></a></li><li><a href="#SparseMatrixColorings.PerfectEliminationOrder"><code>PerfectEliminationOrder</code></a></li><li><a href="#SparseMatrixColorings.RandomOrder"><code>RandomOrder</code></a></li><li><a href="#SparseMatrixColorings.SmallestLast"><code>SmallestLast</code></a></li><li><a href="#SparseMatrixColorings.coloring"><code>coloring</code></a></li><li><a href="#SparseMatrixColorings.column_colors"><code>column_colors</code></a></li><li><a href="#SparseMatrixColorings.column_groups"><code>column_groups</code></a></li><li><a href="#SparseMatrixColorings.compress"><code>compress</code></a></li><li><a href="#SparseMatrixColorings.decompress"><code>decompress</code></a></li><li><a href="#SparseMatrixColorings.decompress!"><code>decompress!</code></a></li><li><a href="#SparseMatrixColorings.decompress_single_color!"><code>decompress_single_color!</code></a></li><li><a href="#SparseMatrixColorings.fast_coloring"><code>fast_coloring</code></a></li><li><a href="#SparseMatrixColorings.ncolors"><code>ncolors</code></a></li><li><a href="#SparseMatrixColorings.row_colors"><code>row_colors</code></a></li><li><a href="#SparseMatrixColorings.row_groups"><code>row_groups</code></a></li><li><a href="#SparseMatrixColorings.sparsity_pattern"><code>sparsity_pattern</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/SparseMatrixColorings.jl/blob/f2f78cd65e581cdbdc5f90e2333d27981597b449/src/SparseMatrixColorings.jl#L1-L9">source</a></section></details></article><h2 id="Main-function"><a class="docs-heading-anchor" href="#Main-function">Main function</a><a id="Main-function-1"></a><a class="docs-heading-anchor-permalink" href="#Main-function" title="Permalink"></a></h2><article><details class="docstring"><summary id="SparseMatrixColorings.coloring"><a class="docstring-binding" href="#SparseMatrixColorings.coloring"><code>SparseMatrixColorings.coloring</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">coloring(
    S::AbstractMatrix,
    problem::ColoringProblem,
    algo::GreedyColoringAlgorithm;
    [decompression_eltype=Float64, symmetric_pattern=false]
)</code></pre><p>Solve a <a href="#SparseMatrixColorings.ColoringProblem"><code>ColoringProblem</code></a> on the matrix <code>S</code> with a <a href="#SparseMatrixColorings.GreedyColoringAlgorithm"><code>GreedyColoringAlgorithm</code></a> and return an <a href="#SparseMatrixColorings.AbstractColoringResult"><code>AbstractColoringResult</code></a>.</p><p>The result can be used to <a href="#SparseMatrixColorings.compress"><code>compress</code></a> and <a href="#SparseMatrixColorings.decompress"><code>decompress</code></a> a matrix <code>A</code> with the same sparsity pattern as <code>S</code>. If <code>eltype(A) == decompression_eltype</code>, decompression might be faster.</p><p>For a <code>:nonsymmetric</code> problem (and only then), setting <code>symmetric_pattern=true</code> indicates that the pattern of nonzeros is symmetric. This condition is weaker than the symmetry of actual values, so it can happen for some Jacobians. Specifying it allows faster construction of the bipartite graph.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using SparseMatrixColorings, SparseArrays

julia&gt; S = sparse([
           0 0 1 1 0 1
           1 0 0 0 1 0
           0 1 0 0 1 0
           0 1 1 0 0 0
       ]);

julia&gt; problem = ColoringProblem(; structure=:nonsymmetric, partition=:column);

julia&gt; algo = GreedyColoringAlgorithm(; decompression=:direct);

julia&gt; result = coloring(S, problem, algo);

julia&gt; column_colors(result)
6-element Vector{Int64}:
 1
 1
 2
 1
 2
 3

julia&gt; collect.(column_groups(result))
3-element Vector{Vector{Int64}}:
 [1, 2, 4]
 [3, 5]
 [6]</code></pre><p><strong>See also</strong></p><ul><li><a href="#SparseMatrixColorings.ColoringProblem"><code>ColoringProblem</code></a></li><li><a href="#SparseMatrixColorings.GreedyColoringAlgorithm"><code>GreedyColoringAlgorithm</code></a></li><li><a href="#SparseMatrixColorings.AbstractColoringResult"><code>AbstractColoringResult</code></a></li><li><a href="#SparseMatrixColorings.compress"><code>compress</code></a></li><li><a href="#SparseMatrixColorings.decompress"><code>decompress</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/SparseMatrixColorings.jl/blob/f2f78cd65e581cdbdc5f90e2333d27981597b449/src/interface.jl#L142-L200">source</a></section></details></article><article><details class="docstring"><summary id="SparseMatrixColorings.fast_coloring"><a class="docstring-binding" href="#SparseMatrixColorings.fast_coloring"><code>SparseMatrixColorings.fast_coloring</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">fast_coloring(
    S::AbstractMatrix,
    problem::ColoringProblem,
    algo::GreedyColoringAlgorithm;
    [symmetric_pattern=false]
)</code></pre><p>Solve a <a href="#SparseMatrixColorings.ColoringProblem"><code>ColoringProblem</code></a> on the matrix <code>S</code> with a <a href="#SparseMatrixColorings.GreedyColoringAlgorithm"><code>GreedyColoringAlgorithm</code></a> and return</p><ul><li>a single color vector for <code>:column</code> and <code>:row</code> problems</li><li>a tuple of color vectors for <code>:bidirectional</code> problems</li></ul><p>This function is very similar to <a href="#SparseMatrixColorings.coloring"><code>coloring</code></a>, but it skips the computation of an <a href="#SparseMatrixColorings.AbstractColoringResult"><code>AbstractColoringResult</code></a> to speed things up.</p><p><strong>See also</strong></p><ul><li><a href="#SparseMatrixColorings.coloring"><code>coloring</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/SparseMatrixColorings.jl/blob/f2f78cd65e581cdbdc5f90e2333d27981597b449/src/interface.jl#L211-L229">source</a></section></details></article><article><details class="docstring"><summary id="SparseMatrixColorings.ColoringProblem"><a class="docstring-binding" href="#SparseMatrixColorings.ColoringProblem"><code>SparseMatrixColorings.ColoringProblem</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ColoringProblem{structure,partition}</code></pre><p>Selector type for the coloring problem to solve, enabling multiple dispatch.</p><p>It is passed as an argument to the main function <a href="#SparseMatrixColorings.coloring"><code>coloring</code></a>.</p><p><strong>Constructors</strong></p><pre><code class="language-julia hljs">ColoringProblem{structure,partition}()
ColoringProblem(; structure=:nonsymmetric, partition=:column)</code></pre><ul><li><code>structure::Symbol</code>: either <code>:nonsymmetric</code> or <code>:symmetric</code></li><li><code>partition::Symbol</code>: either <code>:column</code>, <code>:row</code> or <code>:bidirectional</code></li></ul><div class="admonition is-warning" id="Warning-300964a87f125218"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-300964a87f125218" title="Permalink"></a></header><div class="admonition-body"><p>The second constructor (based on keyword arguments) is type-unstable.</p></div></div><p><strong>Link to automatic differentiation</strong></p><p>Matrix coloring is often used in automatic differentiation, and here is the translation guide:</p><table><tr><th style="text-align: right">matrix</th><th style="text-align: right">mode</th><th style="text-align: right"><code>structure</code></th><th style="text-align: right"><code>partition</code></th><th style="text-align: right">implemented</th></tr><tr><td style="text-align: right">Jacobian</td><td style="text-align: right">forward</td><td style="text-align: right"><code>:nonsymmetric</code></td><td style="text-align: right"><code>:column</code></td><td style="text-align: right">yes</td></tr><tr><td style="text-align: right">Jacobian</td><td style="text-align: right">reverse</td><td style="text-align: right"><code>:nonsymmetric</code></td><td style="text-align: right"><code>:row</code></td><td style="text-align: right">yes</td></tr><tr><td style="text-align: right">Jacobian</td><td style="text-align: right">mixed</td><td style="text-align: right"><code>:nonsymmetric</code></td><td style="text-align: right"><code>:bidirectional</code></td><td style="text-align: right">yes</td></tr><tr><td style="text-align: right">Hessian</td><td style="text-align: right">-</td><td style="text-align: right"><code>:symmetric</code></td><td style="text-align: right"><code>:column</code></td><td style="text-align: right">yes</td></tr><tr><td style="text-align: right">Hessian</td><td style="text-align: right">-</td><td style="text-align: right"><code>:symmetric</code></td><td style="text-align: right"><code>:row</code></td><td style="text-align: right">no</td></tr></table></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/SparseMatrixColorings.jl/blob/f2f78cd65e581cdbdc5f90e2333d27981597b449/src/interface.jl#L26-L55">source</a></section></details></article><h2 id="Coloring-algorithms"><a class="docs-heading-anchor" href="#Coloring-algorithms">Coloring algorithms</a><a id="Coloring-algorithms-1"></a><a class="docs-heading-anchor-permalink" href="#Coloring-algorithms" title="Permalink"></a></h2><article><details class="docstring"><summary id="SparseMatrixColorings.GreedyColoringAlgorithm"><a class="docstring-binding" href="#SparseMatrixColorings.GreedyColoringAlgorithm"><code>SparseMatrixColorings.GreedyColoringAlgorithm</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">GreedyColoringAlgorithm{decompression} &lt;: ADTypes.AbstractColoringAlgorithm</code></pre><p>Greedy coloring algorithm for sparse matrices which colors columns or rows one after the other, following a configurable order.</p><p>It is passed as an argument to the main function <a href="#SparseMatrixColorings.coloring"><code>coloring</code></a>.</p><p><strong>Constructors</strong></p><pre><code class="language-julia hljs">GreedyColoringAlgorithm{decompression}(order=NaturalOrder(); postprocessing=false, postprocessing_minimizes=:all_colors, decompression_uplo=:F)
GreedyColoringAlgorithm(order=NaturalOrder(); postprocessing=false, postprocessing_minimizes=:all_colors, decompression=:direct, decompression_uplo=:F)</code></pre><ul><li><code>order::Union{AbstractOrder,Tuple}</code>: the order in which the columns or rows are colored, which can impact the number of colors. Can also be a tuple of different orders to try out, from which the best order (the one with the lowest total number of colors) will be used.</li><li><code>postprocessing::Bool</code>: whether or not the coloring will be refined by assigning the neutral color <code>0</code> to some vertices. This option does not affect row or column colorings.</li><li><code>postprocessing_minimizes::Symbol</code>: which number of distinct colors is heuristically minimized by postprocessing, either <code>:all_colors</code>, <code>:row_colors</code> or <code>:column_colors</code>. This option only affects bidirectional colorings.</li><li><code>decompression::Symbol</code>: either <code>:direct</code> or <code>:substitution</code>. Usually <code>:substitution</code> leads to fewer colors, at the cost of a more expensive coloring (and decompression). When <code>:substitution</code> is not applicable, it falls back on <code>:direct</code> decompression.</li><li><code>decompression_uplo::Symbol</code>: either <code>:L</code> (lower triangle), <code>:U</code> (upper triangle), or <code>:F</code> (full matrix). This option only affects symmetric colorings.</li></ul><div class="admonition is-warning" id="Warning-300964a87f125218"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-300964a87f125218" title="Permalink"></a></header><div class="admonition-body"><p>The second constructor (based on keyword arguments) is type-unstable.</p></div></div><p><strong>ADTypes coloring interface</strong></p><p><code>GreedyColoringAlgorithm</code> is a subtype of <a href="https://sciml.github.io/ADTypes.jl/stable/#ADTypes.AbstractColoringAlgorithm"><code>ADTypes.AbstractColoringAlgorithm</code></a>, which means the following methods are also applicable:</p><ul><li><a href="https://sciml.github.io/ADTypes.jl/stable/#ADTypes.column_coloring"><code>ADTypes.column_coloring</code></a></li><li><a href="https://sciml.github.io/ADTypes.jl/stable/#ADTypes.row_coloring"><code>ADTypes.row_coloring</code></a></li><li><a href="https://sciml.github.io/ADTypes.jl/stable/#ADTypes.symmetric_coloring"><code>ADTypes.symmetric_coloring</code></a></li></ul><p>See their respective docstrings for details.</p><p><strong>See also</strong></p><ul><li><a href="#SparseMatrixColorings.AbstractOrder"><code>AbstractOrder</code></a></li><li><a href="#SparseMatrixColorings.decompress"><code>decompress</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/SparseMatrixColorings.jl/blob/f2f78cd65e581cdbdc5f90e2333d27981597b449/src/interface.jl#L63-L98">source</a></section></details></article><article><details class="docstring"><summary id="SparseMatrixColorings.ConstantColoringAlgorithm"><a class="docstring-binding" href="#SparseMatrixColorings.ConstantColoringAlgorithm"><code>SparseMatrixColorings.ConstantColoringAlgorithm</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ConstantColoringAlgorithm{partition}  &lt;: ADTypes.AbstractColoringAlgorithm</code></pre><p>Coloring algorithm which always returns the same precomputed vector of colors. Useful when the optimal coloring of a matrix can be determined a priori due to its specific structure (e.g. banded).</p><p>It is passed as an argument to the main function <a href="#SparseMatrixColorings.coloring"><code>coloring</code></a>, but will only work if the associated <code>problem</code> has a <code>:column</code> or <code>:row</code> partition.</p><p><strong>Constructors</strong></p><pre><code class="language-julia hljs">ConstantColoringAlgorithm{partition}(matrix_template, color)
ConstantColoringAlgorithm{partition,structure}(matrix_template, color)
ConstantColoringAlgorithm(
    matrix_template, color;
    structure=:nonsymmetric, partition=:column
)</code></pre><ul><li><code>partition::Symbol</code>: either <code>:row</code> or <code>:column</code>.</li><li><code>structure::Symbol</code>: either <code>:nonsymmetric</code> or <code>:symmetric</code>.</li><li><code>matrix_template::AbstractMatrix</code>: matrix for which the vector of colors was precomputed (the algorithm will only accept matrices of the exact same size).</li><li><code>color::Vector{&lt;:Integer}</code>: vector of integer colors, one for each row or column (depending on <code>partition</code>).</li></ul><div class="admonition is-warning" id="Warning-6b2012b59f49dff1"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-6b2012b59f49dff1" title="Permalink"></a></header><div class="admonition-body"><p>The constructor based on keyword arguments is type-unstable if these arguments are not compile-time constants.</p></div></div><p>We do not necessarily verify consistency between the matrix template and the vector of colors, this is the responsibility of the user.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using SparseMatrixColorings, LinearAlgebra

julia&gt; matrix_template = Diagonal(ones(Bool, 5))
5×5 Diagonal{Bool, Vector{Bool}}:
 1  ⋅  ⋅  ⋅  ⋅
 ⋅  1  ⋅  ⋅  ⋅
 ⋅  ⋅  1  ⋅  ⋅
 ⋅  ⋅  ⋅  1  ⋅
 ⋅  ⋅  ⋅  ⋅  1

julia&gt; color = ones(Int, 5)  # coloring a Diagonal is trivial
5-element Vector{Int64}:
 1
 1
 1
 1
 1

julia&gt; problem = ColoringProblem(; structure=:nonsymmetric, partition=:column);

julia&gt; algo = ConstantColoringAlgorithm(matrix_template, color; partition=:column);

julia&gt; result = coloring(similar(matrix_template), problem, algo);

julia&gt; column_colors(result)
5-element Vector{Int64}:
 1
 1
 1
 1
 1</code></pre><p><strong>ADTypes coloring interface</strong></p><p><code>ConstantColoringAlgorithm</code> is a subtype of <a href="https://sciml.github.io/ADTypes.jl/stable/#ADTypes.AbstractColoringAlgorithm"><code>ADTypes.AbstractColoringAlgorithm</code></a>, which means the following methods are also applicable (although they will error if the kind of coloring demanded not consistent):</p><ul><li><a href="https://sciml.github.io/ADTypes.jl/stable/#ADTypes.column_coloring"><code>ADTypes.column_coloring</code></a></li><li><a href="https://sciml.github.io/ADTypes.jl/stable/#ADTypes.row_coloring"><code>ADTypes.row_coloring</code></a></li><li><a href="https://sciml.github.io/ADTypes.jl/stable/#ADTypes.symmetric_coloring"><code>ADTypes.symmetric_coloring</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/SparseMatrixColorings.jl/blob/f2f78cd65e581cdbdc5f90e2333d27981597b449/src/constant.jl#L1-L71">source</a></section></details></article><article><details class="docstring"><summary id="SparseMatrixColorings.OptimalColoringAlgorithm"><a class="docstring-binding" href="#SparseMatrixColorings.OptimalColoringAlgorithm"><code>SparseMatrixColorings.OptimalColoringAlgorithm</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">OptimalColoringAlgorithm</code></pre><p>Coloring algorithm that relies on mathematical programming with <a href="https://jump.dev/">JuMP</a> to find an optimal coloring.</p><div class="admonition is-warning" id="Warning-8a829cb65375d0c4"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-8a829cb65375d0c4" title="Permalink"></a></header><div class="admonition-body"><p>This algorithm is only available when JuMP is loaded. If you encounter a method error, run <code>import JuMP</code> in your REPL and try again. It only works for nonsymmetric, unidirectional colorings problems.</p></div></div><div class="admonition is-danger" id="Danger-dcf71aaa2f7dc891"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-dcf71aaa2f7dc891" title="Permalink"></a></header><div class="admonition-body"><p>The coloring problem is NP-hard, so it is unreasonable to expect an optimal solution in reasonable time for large instances.</p></div></div><p><strong>Constructor</strong></p><pre><code class="language-julia hljs">OptimalColoringAlgorithm(optimizer; silent::Bool=true, assert_solved::Bool=true)</code></pre><p>The <code>optimizer</code> argument can be any JuMP-compatible optimizer. However, the problem formulation is best suited to CP-SAT optimizers like <a href="https://github.com/jump-dev/MiniZinc.jl">MiniZinc</a>. You can use <a href="https://jump.dev/JuMP.jl/stable/api/JuMP/#optimizer_with_attributes"><code>optimizer_with_attributes</code></a> to set solver-specific parameters.</p><p><strong>Keyword arguments</strong></p><ul><li><code>silent</code>: whether to suppress solver output</li><li><code>assert_solved</code>: whether to check that the solver found an optimal solution (as opposed to running out of time for example)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/SparseMatrixColorings.jl/blob/f2f78cd65e581cdbdc5f90e2333d27981597b449/src/optimal.jl#L1-L25">source</a></section></details></article><h2 id="Result-analysis"><a class="docs-heading-anchor" href="#Result-analysis">Result analysis</a><a id="Result-analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Result-analysis" title="Permalink"></a></h2><article><details class="docstring"><summary id="SparseMatrixColorings.AbstractColoringResult"><a class="docstring-binding" href="#SparseMatrixColorings.AbstractColoringResult"><code>SparseMatrixColorings.AbstractColoringResult</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">AbstractColoringResult{structure,partition,decompression}</code></pre><p>Abstract type for the result of a coloring algorithm.</p><p>It is the supertype of the object returned by the main function <a href="#SparseMatrixColorings.coloring"><code>coloring</code></a>.</p><p><strong>Type parameters</strong></p><p>Combination between the type parameters of <a href="#SparseMatrixColorings.ColoringProblem"><code>ColoringProblem</code></a> and <a href="#SparseMatrixColorings.GreedyColoringAlgorithm"><code>GreedyColoringAlgorithm</code></a>:</p><ul><li><code>structure::Symbol</code>: either <code>:nonsymmetric</code> or <code>:symmetric</code></li><li><code>partition::Symbol</code>: either <code>:column</code>, <code>:row</code> or <code>:bidirectional</code></li><li><code>decompression::Symbol</code>: either <code>:direct</code> or <code>:substitution</code></li></ul><p><strong>Applicable methods</strong></p><ul><li><a href="#SparseMatrixColorings.column_colors"><code>column_colors</code></a> and <a href="#SparseMatrixColorings.column_groups"><code>column_groups</code></a> (for a <code>:column</code> or <code>:bidirectional</code> partition) </li><li><a href="#SparseMatrixColorings.row_colors"><code>row_colors</code></a> and <a href="#SparseMatrixColorings.row_groups"><code>row_groups</code></a> (for a <code>:row</code> or <code>:bidirectional</code> partition)</li><li><a href="#SparseMatrixColorings.sparsity_pattern"><code>sparsity_pattern</code></a></li><li><a href="#SparseMatrixColorings.compress"><code>compress</code></a>, <a href="#SparseMatrixColorings.decompress"><code>decompress</code></a>, <a href="#SparseMatrixColorings.decompress!"><code>decompress!</code></a>, <a href="#SparseMatrixColorings.decompress_single_color!"><code>decompress_single_color!</code></a></li></ul><div class="admonition is-warning" id="Warning-6dd00e0486b6aad8"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-6dd00e0486b6aad8" title="Permalink"></a></header><div class="admonition-body"><p>Unlike the methods above, the concrete subtypes of <code>AbstractColoringResult</code> are not part of the public API and may change without notice.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/SparseMatrixColorings.jl/blob/f2f78cd65e581cdbdc5f90e2333d27981597b449/src/result.jl#L3-L27">source</a></section></details></article><article><details class="docstring"><summary id="SparseMatrixColorings.column_colors"><a class="docstring-binding" href="#SparseMatrixColorings.column_colors"><code>SparseMatrixColorings.column_colors</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">column_colors(result::AbstractColoringResult)</code></pre><p>Return a vector <code>color</code> of integer colors, one for each column of the colored matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/SparseMatrixColorings.jl/blob/f2f78cd65e581cdbdc5f90e2333d27981597b449/src/result.jl#L30-L34">source</a></section></details></article><article><details class="docstring"><summary id="SparseMatrixColorings.row_colors"><a class="docstring-binding" href="#SparseMatrixColorings.row_colors"><code>SparseMatrixColorings.row_colors</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">row_colors(result::AbstractColoringResult)</code></pre><p>Return a vector <code>color</code> of integer colors, one for each row of the colored matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/SparseMatrixColorings.jl/blob/f2f78cd65e581cdbdc5f90e2333d27981597b449/src/result.jl#L37-L41">source</a></section></details></article><article><details class="docstring"><summary id="SparseMatrixColorings.ncolors"><a class="docstring-binding" href="#SparseMatrixColorings.ncolors"><code>SparseMatrixColorings.ncolors</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">ncolors(result::AbstractColoringResult)</code></pre><p>Return the number of different non-zero colors used to color the matrix.</p><p>For bidirectional partitions, this number is the sum of the number of non-zero row colors and the number of non-zero column colors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/SparseMatrixColorings.jl/blob/f2f78cd65e581cdbdc5f90e2333d27981597b449/src/result.jl#L58-L64">source</a></section></details></article><article><details class="docstring"><summary id="SparseMatrixColorings.column_groups"><a class="docstring-binding" href="#SparseMatrixColorings.column_groups"><code>SparseMatrixColorings.column_groups</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">column_groups(result::AbstractColoringResult)</code></pre><p>Return a vector <code>group</code> such that for every non-zero color <code>c</code>, <code>group[c]</code> contains the indices of all columns that are colored with <code>c</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/SparseMatrixColorings.jl/blob/f2f78cd65e581cdbdc5f90e2333d27981597b449/src/result.jl#L44-L48">source</a></section></details></article><article><details class="docstring"><summary id="SparseMatrixColorings.row_groups"><a class="docstring-binding" href="#SparseMatrixColorings.row_groups"><code>SparseMatrixColorings.row_groups</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">row_groups(result::AbstractColoringResult)</code></pre><p>Return a vector <code>group</code> such that for every non-zero color <code>c</code>, <code>group[c]</code> contains the indices of all rows that are colored with <code>c</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/SparseMatrixColorings.jl/blob/f2f78cd65e581cdbdc5f90e2333d27981597b449/src/result.jl#L51-L55">source</a></section></details></article><article><details class="docstring"><summary id="SparseMatrixColorings.sparsity_pattern"><a class="docstring-binding" href="#SparseMatrixColorings.sparsity_pattern"><code>SparseMatrixColorings.sparsity_pattern</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">sparsity_pattern(result::AbstractColoringResult)</code></pre><p>Return the matrix that was initially passed to <a href="#SparseMatrixColorings.coloring"><code>coloring</code></a>, without any modifications.</p><div class="admonition is-info" id="Note-c9a4b7ee8f6fcba"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-c9a4b7ee8f6fcba" title="Permalink"></a></header><div class="admonition-body"><p>This matrix is not necessarily a <code>SparseMatrixCSC</code>, nor does it necessarily have <code>Bool</code> entries.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/SparseMatrixColorings.jl/blob/f2f78cd65e581cdbdc5f90e2333d27981597b449/src/result.jl#L123-L130">source</a></section></details></article><h2 id="Decompression"><a class="docs-heading-anchor" href="#Decompression">Decompression</a><a id="Decompression-1"></a><a class="docs-heading-anchor-permalink" href="#Decompression" title="Permalink"></a></h2><article><details class="docstring"><summary id="SparseMatrixColorings.compress"><a class="docstring-binding" href="#SparseMatrixColorings.compress"><code>SparseMatrixColorings.compress</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">compress(A, result::AbstractColoringResult)</code></pre><p>Compress <code>A</code> given a coloring <code>result</code> of the sparsity pattern of <code>A</code>.</p><ul><li>If <code>result</code> comes from a <code>:column</code> (resp. <code>:row</code>) partition, the output is a single matrix <code>B</code> compressed by column (resp. by row).</li><li>If <code>result</code> comes from a <code>:bidirectional</code> partition, the output is a tuple of matrices <code>(Br, Bc)</code>, where <code>Br</code> is compressed by row and <code>Bc</code> by column.</li></ul><p>Compression means summing either the columns or the rows of <code>A</code> which share the same color. It is undone by calling <a href="#SparseMatrixColorings.decompress"><code>decompress</code></a> or <a href="#SparseMatrixColorings.decompress!"><code>decompress!</code></a>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using SparseMatrixColorings, SparseArrays

julia&gt; A = sparse([
           0 0 4 6 0 9
           1 0 0 0 7 0
           0 2 0 0 8 0
           0 3 5 0 0 0
       ]);

julia&gt; result = coloring(A, ColoringProblem(), GreedyColoringAlgorithm());

julia&gt; collect.(column_groups(result))
3-element Vector{Vector{Int64}}:
 [1, 2, 4]
 [3, 5]
 [6]

julia&gt; B = compress(A, result)
4×3 Matrix{Int64}:
 6  4  9
 1  7  0
 2  8  0
 3  5  0</code></pre><p><strong>See also</strong></p><ul><li><a href="#SparseMatrixColorings.ColoringProblem"><code>ColoringProblem</code></a></li><li><a href="#SparseMatrixColorings.AbstractColoringResult"><code>AbstractColoringResult</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/SparseMatrixColorings.jl/blob/f2f78cd65e581cdbdc5f90e2333d27981597b449/src/decompression.jl#L1-L44">source</a></section></details></article><article><details class="docstring"><summary id="SparseMatrixColorings.decompress"><a class="docstring-binding" href="#SparseMatrixColorings.decompress"><code>SparseMatrixColorings.decompress</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">decompress(B::AbstractMatrix, result::AbstractColoringResult{_,:column/:row})
decompress(Br::AbstractMatrix, Bc::AbstractMatrix, result::AbstractColoringResult{_,:bidirectional})</code></pre><p>Decompress <code>B</code> (or the tuple <code>(Br,Bc)</code>) into a new matrix <code>A</code>, given a coloring <code>result</code> of the sparsity pattern of <code>A</code>. The in-place alternative is <a href="#SparseMatrixColorings.decompress!"><code>decompress!</code></a>.</p><p>Compression means summing either the columns or the rows of <code>A</code> which share the same color. It is done by calling <a href="#SparseMatrixColorings.compress"><code>compress</code></a>.</p><div class="admonition is-warning" id="Warning-78481e59648563d5"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-78481e59648563d5" title="Permalink"></a></header><div class="admonition-body"><p>For some coloring variants, the <code>result</code> object is mutated during decompression.</p></div></div><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using SparseMatrixColorings, SparseArrays

julia&gt; A = sparse([
           0 0 4 6 0 9
           1 0 0 0 7 0
           0 2 0 0 8 0
           0 3 5 0 0 0
       ]);

julia&gt; result = coloring(A, ColoringProblem(), GreedyColoringAlgorithm());

julia&gt; collect.(column_groups(result))
3-element Vector{Vector{Int64}}:
 [1, 2, 4]
 [3, 5]
 [6]

julia&gt; B = compress(A, result)
4×3 Matrix{Int64}:
 6  4  9
 1  7  0
 2  8  0
 3  5  0

julia&gt; decompress(B, result)
4×6 SparseMatrixCSC{Int64, Int64} with 9 stored entries:
 ⋅  ⋅  4  6  ⋅  9
 1  ⋅  ⋅  ⋅  7  ⋅
 ⋅  2  ⋅  ⋅  8  ⋅
 ⋅  3  5  ⋅  ⋅  ⋅

julia&gt; decompress(B, result) == A
true</code></pre><p><strong>See also</strong></p><ul><li><a href="#SparseMatrixColorings.ColoringProblem"><code>ColoringProblem</code></a></li><li><a href="#SparseMatrixColorings.AbstractColoringResult"><code>AbstractColoringResult</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/SparseMatrixColorings.jl/blob/f2f78cd65e581cdbdc5f90e2333d27981597b449/src/decompression.jl#L117-L172">source</a></section></details></article><article><details class="docstring"><summary id="SparseMatrixColorings.decompress!"><a class="docstring-binding" href="#SparseMatrixColorings.decompress!"><code>SparseMatrixColorings.decompress!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">decompress!(
    A::AbstractMatrix, B::AbstractMatrix,
    result::AbstractColoringResult{_,:column/:row},
)

decompress!(
    A::AbstractMatrix, Br::AbstractMatrix, Bc::AbstractMatrix
    result::AbstractColoringResult{_,:bidirectional}
)</code></pre><p>Decompress <code>B</code> (or the tuple <code>(Br,Bc)</code>) in-place into <code>A</code>, given a coloring <code>result</code> of the sparsity pattern of <code>A</code>. The out-of-place alternative is <a href="#SparseMatrixColorings.decompress"><code>decompress</code></a>.</p><div class="admonition is-info" id="Note-4104f03c5b9aabe2"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-4104f03c5b9aabe2" title="Permalink"></a></header><div class="admonition-body"><p>In-place decompression is faster when <code>A isa SparseMatrixCSC</code>.</p></div></div><p>Compression means summing either the columns or the rows of <code>A</code> which share the same color. It is done by calling <a href="#SparseMatrixColorings.compress"><code>compress</code></a>.</p><div class="admonition is-warning" id="Warning-78481e59648563d5"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-78481e59648563d5" title="Permalink"></a></header><div class="admonition-body"><p>For some coloring variants, the <code>result</code> object is mutated during decompression.</p></div></div><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using SparseMatrixColorings, SparseArrays

julia&gt; A = sparse([
           0 0 4 6 0 9
           1 0 0 0 7 0
           0 2 0 0 8 0
           0 3 5 0 0 0
       ]);

julia&gt; result = coloring(A, ColoringProblem(), GreedyColoringAlgorithm());

julia&gt; collect.(column_groups(result))
3-element Vector{Vector{Int64}}:
 [1, 2, 4]
 [3, 5]
 [6]

julia&gt; B = compress(A, result)
4×3 Matrix{Int64}:
 6  4  9
 1  7  0
 2  8  0
 3  5  0

julia&gt; A2 = similar(A);

julia&gt; decompress!(A2, B, result)
4×6 SparseMatrixCSC{Int64, Int64} with 9 stored entries:
 ⋅  ⋅  4  6  ⋅  9
 1  ⋅  ⋅  ⋅  7  ⋅
 ⋅  2  ⋅  ⋅  8  ⋅
 ⋅  3  5  ⋅  ⋅  ⋅

julia&gt; A2 == A
true</code></pre><p><strong>See also</strong></p><ul><li><a href="#SparseMatrixColorings.ColoringProblem"><code>ColoringProblem</code></a></li><li><a href="#SparseMatrixColorings.AbstractColoringResult"><code>AbstractColoringResult</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/SparseMatrixColorings.jl/blob/f2f78cd65e581cdbdc5f90e2333d27981597b449/src/decompression.jl#L202-L269">source</a></section></details></article><article><details class="docstring"><summary id="SparseMatrixColorings.decompress_single_color!"><a class="docstring-binding" href="#SparseMatrixColorings.decompress_single_color!"><code>SparseMatrixColorings.decompress_single_color!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">decompress_single_color!(
    A::AbstractMatrix, b::AbstractVector, c::Integer,
    result::AbstractColoringResult,
)</code></pre><p>Decompress the vector <code>b</code> corresponding to color <code>c</code> in-place into <code>A</code>, given a <code>:direct</code> coloring <code>result</code> of the sparsity pattern of <code>A</code> (it will not work with a <code>:substitution</code> coloring).</p><ul><li>If <code>result</code> comes from a <code>:nonsymmetric</code> structure with <code>:column</code> partition, this will update the columns of <code>A</code> that share color <code>c</code> (whose sum makes up <code>b</code>).</li><li>If <code>result</code> comes from a <code>:nonsymmetric</code> structure with <code>:row</code> partition, this will update the rows of <code>A</code> that share color <code>c</code> (whose sum makes up <code>b</code>).</li><li>If <code>result</code> comes from a <code>:symmetric</code> structure with <code>:column</code> partition, this will update the coefficients of <code>A</code> whose value is deduced from color <code>c</code>.</li></ul><div class="admonition is-warning" id="Warning-c1d96e450a3a5646"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-c1d96e450a3a5646" title="Permalink"></a></header><div class="admonition-body"><p>This function will only update some coefficients of <code>A</code>, without resetting the rest to zero.</p></div></div><div class="admonition is-warning" id="Warning-78481e59648563d5"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-78481e59648563d5" title="Permalink"></a></header><div class="admonition-body"><p>For some coloring variants, the <code>result</code> object is mutated during decompression.</p></div></div><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using SparseMatrixColorings, SparseArrays

julia&gt; A = sparse([
           0 0 4 6 0 9
           1 0 0 0 7 0
           0 2 0 0 8 0
           0 3 5 0 0 0
       ]);

julia&gt; result = coloring(A, ColoringProblem(), GreedyColoringAlgorithm());

julia&gt; collect.(column_groups(result))
3-element Vector{Vector{Int64}}:
 [1, 2, 4]
 [3, 5]
 [6]

julia&gt; B = compress(A, result)
4×3 Matrix{Int64}:
 6  4  9
 1  7  0
 2  8  0
 3  5  0

julia&gt; A2 = similar(A); A2 .= 0;

julia&gt; decompress_single_color!(A2, B[:, 2], 2, result)
4×6 SparseMatrixCSC{Int64, Int64} with 9 stored entries:
 ⋅  ⋅  4  0  ⋅  0
 0  ⋅  ⋅  ⋅  7  ⋅
 ⋅  0  ⋅  ⋅  8  ⋅
 ⋅  0  5  ⋅  ⋅  ⋅

julia&gt; A2[:, [3, 5]] == A[:, [3, 5]]
true</code></pre><p><strong>See also</strong></p><ul><li><a href="#SparseMatrixColorings.ColoringProblem"><code>ColoringProblem</code></a></li><li><a href="#SparseMatrixColorings.AbstractColoringResult"><code>AbstractColoringResult</code></a></li><li><a href="#SparseMatrixColorings.decompress!"><code>decompress!</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/SparseMatrixColorings.jl/blob/f2f78cd65e581cdbdc5f90e2333d27981597b449/src/decompression.jl#L272-L335">source</a></section></details></article><h2 id="Orders"><a class="docs-heading-anchor" href="#Orders">Orders</a><a id="Orders-1"></a><a class="docs-heading-anchor-permalink" href="#Orders" title="Permalink"></a></h2><article><details class="docstring"><summary id="SparseMatrixColorings.AbstractOrder"><a class="docstring-binding" href="#SparseMatrixColorings.AbstractOrder"><code>SparseMatrixColorings.AbstractOrder</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">AbstractOrder</code></pre><p>Abstract supertype for the vertex order used inside <a href="#SparseMatrixColorings.GreedyColoringAlgorithm"><code>GreedyColoringAlgorithm</code></a>.</p><p>In this algorithm, the rows and columns of a matrix form a graph, and the vertices are colored one after the other in a greedy fashion. Depending on how the vertices are ordered, the number of colors necessary may vary.</p><p><strong>Options</strong></p><ul><li><a href="#SparseMatrixColorings.NaturalOrder"><code>NaturalOrder</code></a></li><li><a href="#SparseMatrixColorings.RandomOrder"><code>RandomOrder</code></a></li><li><a href="#SparseMatrixColorings.LargestFirst"><code>LargestFirst</code></a></li><li><a href="#SparseMatrixColorings.IncidenceDegree"><code>IncidenceDegree</code></a> (experimental)</li><li><a href="#SparseMatrixColorings.SmallestLast"><code>SmallestLast</code></a> (experimental)</li><li><a href="#SparseMatrixColorings.DynamicLargestFirst"><code>DynamicLargestFirst</code></a> (experimental)</li><li><a href="#SparseMatrixColorings.PerfectEliminationOrder"><code>PerfectEliminationOrder</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/SparseMatrixColorings.jl/blob/f2f78cd65e581cdbdc5f90e2333d27981597b449/src/order.jl#L1-L18">source</a></section></details></article><article><details class="docstring"><summary id="SparseMatrixColorings.NaturalOrder"><a class="docstring-binding" href="#SparseMatrixColorings.NaturalOrder"><code>SparseMatrixColorings.NaturalOrder</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">NaturalOrder()</code></pre><p>Instance of <a href="#SparseMatrixColorings.AbstractOrder"><code>AbstractOrder</code></a> which sorts vertices using their index in the provided graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/SparseMatrixColorings.jl/blob/f2f78cd65e581cdbdc5f90e2333d27981597b449/src/order.jl#L21-L25">source</a></section></details></article><article><details class="docstring"><summary id="SparseMatrixColorings.RandomOrder"><a class="docstring-binding" href="#SparseMatrixColorings.RandomOrder"><code>SparseMatrixColorings.RandomOrder</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">RandomOrder(rng=default_rng(), seed=nothing)</code></pre><p>Instance of <a href="#SparseMatrixColorings.AbstractOrder"><code>AbstractOrder</code></a> which sorts vertices using a random permutation, generated from <code>rng</code> with a given <code>seed</code>.</p><ul><li>If <code>seed = nothing</code>, the <code>rng</code> will never be re-seeded. Therefore, two consecutive calls to <code>vertices(g, order)</code> will give different results.</li><li>Otherwise, the <code>rng</code> will be re-seeded before each sample. Therefore, two consecutive calls to <code>vertices(g, order)</code> will give the same result.</li></ul><div class="admonition is-warning" id="Warning-fc43306e314f6879"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-fc43306e314f6879" title="Permalink"></a></header><div class="admonition-body"><p>Do not use a seed with the <code>default_rng()</code>, otherwise you will affect the global state of your program. If you need reproducibility, create a new <code>rng</code> specifically for your <code>RandomOrder</code>. The package <a href="https://github.com/JuliaRandom/StableRNGs.jl">StableRNGs.jl</a> offers random number generators whose behavior is stable across Julia versions.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/SparseMatrixColorings.jl/blob/f2f78cd65e581cdbdc5f90e2333d27981597b449/src/order.jl#L36-L48">source</a></section></details></article><article><details class="docstring"><summary id="SparseMatrixColorings.LargestFirst"><a class="docstring-binding" href="#SparseMatrixColorings.LargestFirst"><code>SparseMatrixColorings.LargestFirst</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">LargestFirst()</code></pre><p>Instance of <a href="#SparseMatrixColorings.AbstractOrder"><code>AbstractOrder</code></a> which sorts vertices using their degree in the provided graph: the largest degree comes first.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/SparseMatrixColorings.jl/blob/f2f78cd65e581cdbdc5f90e2333d27981597b449/src/order.jl#L75-L79">source</a></section></details></article><article><details class="docstring"><summary id="SparseMatrixColorings.SmallestLast"><a class="docstring-binding" href="#SparseMatrixColorings.SmallestLast"><code>SparseMatrixColorings.SmallestLast</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">SmallestLast(; reproduce_colpack=false)</code></pre><p>Instance of <a href="#SparseMatrixColorings.AbstractOrder"><code>AbstractOrder</code></a> which sorts vertices from highest to lowest using the dynamic back degree.</p><p><strong>See also</strong></p><ul><li><a href="#SparseMatrixColorings.DynamicDegreeBasedOrder"><code>DynamicDegreeBasedOrder</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/SparseMatrixColorings.jl/blob/f2f78cd65e581cdbdc5f90e2333d27981597b449/src/order.jl#L421-L429">source</a></section></details></article><article><details class="docstring"><summary id="SparseMatrixColorings.IncidenceDegree"><a class="docstring-binding" href="#SparseMatrixColorings.IncidenceDegree"><code>SparseMatrixColorings.IncidenceDegree</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">IncidenceDegree(; reproduce_colpack=false)</code></pre><p>Instance of <a href="#SparseMatrixColorings.AbstractOrder"><code>AbstractOrder</code></a> which sorts vertices from lowest to highest using the dynamic back degree.</p><p><strong>See also</strong></p><ul><li><a href="#SparseMatrixColorings.DynamicDegreeBasedOrder"><code>DynamicDegreeBasedOrder</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/SparseMatrixColorings.jl/blob/f2f78cd65e581cdbdc5f90e2333d27981597b449/src/order.jl#L408-L416">source</a></section></details></article><article><details class="docstring"><summary id="SparseMatrixColorings.DynamicLargestFirst"><a class="docstring-binding" href="#SparseMatrixColorings.DynamicLargestFirst"><code>SparseMatrixColorings.DynamicLargestFirst</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">DynamicLargestFirst(; reproduce_colpack=false)</code></pre><p>Instance of <a href="#SparseMatrixColorings.AbstractOrder"><code>AbstractOrder</code></a> which sorts vertices from lowest to highest using the dynamic forward degree.</p><p><strong>See also</strong></p><ul><li><a href="#SparseMatrixColorings.DynamicDegreeBasedOrder"><code>DynamicDegreeBasedOrder</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/SparseMatrixColorings.jl/blob/f2f78cd65e581cdbdc5f90e2333d27981597b449/src/order.jl#L434-L442">source</a></section></details></article><article><details class="docstring"><summary id="SparseMatrixColorings.DynamicDegreeBasedOrder"><a class="docstring-binding" href="#SparseMatrixColorings.DynamicDegreeBasedOrder"><code>SparseMatrixColorings.DynamicDegreeBasedOrder</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">DynamicDegreeBasedOrder{degtype,direction}(; reproduce_colpack=false)</code></pre><p>Instance of <a href="#SparseMatrixColorings.AbstractOrder"><code>AbstractOrder</code></a> which sorts vertices using a dynamically computed degree.</p><p>This order works by assigning vertices to buckets based on their dynamic degree, and then updating buckets iteratively by transfering vertices between them.</p><p><strong>Type parameters</strong></p><ul><li><code>degtype::Symbol</code>: can be <code>:forward</code> (for the forward degree) or <code>:back</code> (for the back degree)</li><li><code>direction::Symbol</code>: can be <code>:low2high</code> (if the order is defined from lowest to highest, i.e. <code>1</code> to <code>n</code>) or <code>:high2low</code> (if the order is defined from highest to lowest, i.e. <code>n</code> to <code>1</code>)</li></ul><p><strong>Concrete variants</strong></p><ul><li><a href="#SparseMatrixColorings.IncidenceDegree"><code>IncidenceDegree</code></a></li><li><a href="#SparseMatrixColorings.SmallestLast"><code>SmallestLast</code></a></li><li><a href="#SparseMatrixColorings.DynamicLargestFirst"><code>DynamicLargestFirst</code></a></li></ul><p><strong>Settings</strong></p><ul><li><code>reproduce_colpack::Bool</code>: whether to manage the buckets in the exact same way as the original ColPack implementation.<ul><li>When <code>reproduce_colpack=true</code>, we always append and remove vertices at the end of a bucket (unilateral).</li><li>When <code>reproduce_colpack=false</code> (the default), we can append and remove vertices either at the start or at the end of a bucket (bilateral).</li></ul></li></ul><p>Allowing modifications on both sides of a bucket enables storage optimization, with a single fixed-size vector for all buckets instead of one dynamically-sized vector per bucket. As a result, the default setting <code>reproduce_colpack=false</code> is slightly more memory-efficient.</p><p><strong>References</strong></p><ul><li><a href="https://dl.acm.org/doi/10.1145/2513109.2513110"><em>ColPack: Software for graph coloring and related problems in scientific computing</em></a>, Gebremedhin et al. (2013), Section 5</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/SparseMatrixColorings.jl/blob/f2f78cd65e581cdbdc5f90e2333d27981597b449/src/order.jl#L109-L139">source</a></section></details></article><article><details class="docstring"><summary id="SparseMatrixColorings.PerfectEliminationOrder"><a class="docstring-binding" href="#SparseMatrixColorings.PerfectEliminationOrder"><code>SparseMatrixColorings.PerfectEliminationOrder</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">PerfectEliminationOrder(elimination_algorithm=CliqueTrees.MCS())</code></pre><p>Instance of <a href="#SparseMatrixColorings.AbstractOrder"><code>AbstractOrder</code></a> which computes a perfect elimination ordering when the underlying graph is <a href="https://en.wikipedia.org/wiki/Chordal_graph">chordal</a>. For non-chordal graphs, it computes a suboptimal ordering.</p><p>The <code>elimination_algorithm</code> must be an instance of <code>CliqueTrees.EliminationAlgorithm</code>.</p><div class="admonition is-warning" id="Warning-5cf0941a9834dc4c"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-5cf0941a9834dc4c" title="Permalink"></a></header><div class="admonition-body"><p>This order can only be applied for symmetric or bidirectional coloring problems. Furthermore, its theoretical guarantees only hold for decompression by substitution.</p></div></div><div class="admonition is-danger" id="Danger-30dbe97b3440784f"><header class="admonition-header">Danger<a class="admonition-anchor" href="#Danger-30dbe97b3440784f" title="Permalink"></a></header><div class="admonition-body"><p>This order is implemented as a package extension and requires loading <a href="https://github.com/AlgebraicJulia/CliqueTrees.jl">CliqueTrees.jl</a>.</p></div></div><p><strong>References</strong></p><ul><li><a href="https://epubs.siam.org/doi/10.1137/0213035">Simple Linear-Time Algorithms to Test Chordality of Graphs, Test Acyclicity of Hypergraphs, and Selectively Reduce Acyclic Hypergraphs</a>, Tarjan and Yannakakis (1984)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/SparseMatrixColorings.jl/blob/f2f78cd65e581cdbdc5f90e2333d27981597b449/src/order.jl#L447-L463">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorial/">« Tutorial</a><a class="docs-footer-nextpage" href="../dev/">Internals »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Tuesday 30 December 2025 22:39">Tuesday 30 December 2025</span>. Using Julia version 1.12.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body><div data-docstringscollapsed="true"></div></html>
